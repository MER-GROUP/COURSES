'''
–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è —Å –ø–æ–º–æ—â—å—é –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π 
filter(), map(), sorted() –∏ reduce() –≤—ã–≤–æ–¥–∏—Ç –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ 
—Å–ø–∏—Å–æ–∫ primary –≥–æ—Ä–æ–¥–æ–≤ —Å –Ω–∞—Å–µ–ª–µ–Ω–∏–µ–º –±–æ–ª–µ–µ 10 000 000 —á–µ–ª–æ–≤–µ–∫, –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

Cities: Beijing, Buenos Aires, ...

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –¢–µ—Å—Ç–∏—Ä—É—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∏–∫–∞–∫ –Ω–µ "–ø–æ–∫–∞—Ä–∞–µ—Ç" 
–≤–∞—Å –∑–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π filter(), map(), sorted() –∏ reduce(), 
–æ–¥–Ω–∞–∫–æ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ —á–µ—Å—Ç–Ω–æ üòÉ.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –°—Ç–∞–≤–∏—Ç—å –∑–∞–ø—è—Ç—É—é –≤ –∫–æ–Ω—Ü–µ –≤—ã–≤–æ–¥–∞ –Ω–µ –Ω—É–∂–Ω–æ.
'''
# –†–µ—à–µ–Ω–∏–µ
from functools import reduce

data = [['Tokyo', 35676000, 'primary'],
        ['New York', 19354922, 'nan'],
        ['Mexico City', 19028000, 'primary'],
        ['Mumbai', 18978000, 'admin'],
        ['Sao Paulo', 18845000, 'admin'],
        ['Delhi', 15926000, 'admin'],
        ['Shanghai', 14987000, 'admin'],
        ['Kolkata', 14787000, 'admin'],
        ['Los Angeles', 12815475, 'nan'],
        ['Dhaka', 12797394, 'primary'],
        ['Buenos Aires', 12795000, 'primary'],
        ['Karachi', 12130000, 'admin'],
        ['Cairo', 11893000, 'primary'],
        ['Rio de Janeiro', 11748000, 'admin'],
        ['Osaka', 11294000, 'admin'],
        ['Beijing', 11106000, 'primary'],
        ['Manila', 11100000, 'primary'],
        ['Moscow', 10452000, 'primary'],
        ['Istanbul', 10061000, 'admin'],
        ['Paris', 9904000, 'primary']]

print(
    reduce(
        lambda x, y: x + y +', ',
        sorted(
            map(
                lambda x: x[0],
                filter(lambda x: 10000000 < x[1] and 'primary' in x[2], data)
            )
        ),
        'Cities: '
    )[:-2]
)