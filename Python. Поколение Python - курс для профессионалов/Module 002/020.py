'''
–§–∞–π–ª—ã –≤ —Ñ–∞–π–ª–µ üå∂Ô∏èüå∂Ô∏è
–í–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª files.txt, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–∞—Ö. 
–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Ñ–∞–π–ª–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏—è, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª–æ–º 
–ø—Ä–æ–±–µ–ª–∞ ‚Äî –∏–º—è —Ñ–∞–π–ª–∞, –µ–≥–æ —Ä–∞–∑–º–µ—Ä (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ) –∏ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è:

cant-help-myself.mp3 7 MB
keep-yourself-alive.mp3 6 MB
bones.mp3 5 MB
...

–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é, 
–æ–ø—Ä–µ–¥–µ–ª—è—è –æ–±—â–∏–π –æ–±—ä–µ–º —Ñ–∞–π–ª–æ–≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã, –∏ –≤—ã–≤–æ–¥–∏—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ 
–≥—Ä—É–ø–ø—ã —Ñ–∞–π–ª–æ–≤, —É–∫–∞–∑—ã–≤–∞—è –¥–ª—è –∫–∞–∂–¥–æ–π –µ–µ –æ–±—â–∏–π –æ–±—ä–µ–º. –ì—Ä—É–ø–ø—ã –¥–æ–ª–∂–Ω—ã 
–±—ã—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –Ω–∞–∑–≤–∞–Ω–∏–π —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, 
—Ñ–∞–π–ª—ã –≤ –≥—Ä—É–ø–ø–∞—Ö ‚Äî –≤ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –∏—Ö –∏–º–µ–Ω.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –±—ã —Ñ–∞–π–ª files.txt –∏–º–µ–ª –≤–∏–¥:

input.txt 3000 B
scratch.zip 300 MB
output.txt 1 KB
temp.txt 4 KB
boy.bmp 2000 KB
mario.bmp 1 MB
data.zip 900 MB

—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã–ª–∞ –±—ã –≤—ã–≤–µ—Å—Ç–∏:

boy.bmp
mario.bmp
----------
Summary: 3 MB

input.txt
output.txt
temp.txt
----------
Summary: 8 KB

data.zip
scratch.zip
----------
Summary: 1 GB

–≥–¥–µ Summary ‚Äî –æ–±—â–∏–π –æ–±—ä–µ–º —Ñ–∞–π–ª–æ–≤ –≥—Ä—É–ø–ø—ã.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –≤—Å–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 3. –û–±—â–∏–π –æ–±—ä–µ–º —Ñ–∞–π–ª–æ–≤ –≥—Ä—É–ø–ø—ã –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å–∞–º—ã—Ö 
–∫—Ä—É–ø–Ω—ã—Ö (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö) –µ–¥–∏–Ω–∏—Ü–∞—Ö –∏–∑–º–µ—Ä–µ–Ω–∏—è —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º 
–¥–æ —Ü–µ–ª—ã—Ö. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, —Å–Ω–∞—á–∞–ª–∞ —Å–ª–µ–¥—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—É–º–º–∞—Ä–Ω—ã–π 
–æ–±—ä–µ–º –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≥—Ä—É–ø–ø—ã, —Å–∫–∞–∂–µ–º, –≤ –±–∞–π—Ç–∞—Ö, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ 
–ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å–∞–º—ã–µ –∫—Ä—É–ø–Ω—ã–µ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã–µ) 
–µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è. –ü—Ä–∏–º–µ—Ä—ã –ø–µ—Ä–µ–≤–æ–¥–∞:

1023 B -> 1023 B
1300 B -> 1 KB
1900 B -> 2 KB

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 4. –ó–Ω–∞—á–µ–Ω–∏—è –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è —Ç–∞–∫–∏–µ –∂–µ, –∫–∞–∫–∏–µ –ø—Ä–∏–Ω—è—Ç—ã –≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ:

1 KB = 1024 B
1 MB = 1024 KB
1 GB = 1024 MB

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 5.
–£–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å—Å—ã–ª–∫–µ.
https://stepik.org/media/attachments/lesson/569749/files.txt
–û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞—á—É –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å—Å—ã–ª–∫–µ.
https://stepik.org/media/attachments/lesson/569749/clue.txt

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 6. –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ UTF-8.
'''
def print_dict(d): # for tests
    for k, v in d.items():
        for k2, v2 in v.items():
            print(k2, v2)
        print('----------')

def print_arr(arr): # for tests
    for line in arr:
        print(line)
        print('----------')

def print_result_arr(arr): # final output
    for line in arr:
        print(*line[0], sep='\n')
        print('----------')
        print(f'Summary: {line[1]}{line[2]}\n')

if __name__ == '__main__':
    # get name files
    arr = list()
    with open('files.txt', 'rt', encoding='utf-8') as file:
        arr = list(map(str.strip ,file.readlines()))
    # print(arr) # test

    # DB
    dictonary = dict()
    for line in arr:
        name, size, unit = line.split()
        start, end = name.split('.')
        dictonary[end] = dictonary.get(end, dict())
        dictonary[end][unit] = dictonary.get(end, dict()).get(unit, []) + [int(size)]
        dictonary[end][end] = dictonary.get(end, dict()).get(end, []) + [name]
        # dictonary.setdefault(end, dict()).setdefault(unit, []).append(int(size))
        # dictonary.setdefault(end, dict()).setdefault(end, []).append(name)
    # print(dictonary, sep='\n') # test
    # print_dict(dictonary) # test

    # convert to bytes
    size_dict = {
        'B': 1 * 1 ** 1, 
        'KB': 1 * 1024 ** 1, 
        'MB': 1 * 1024 ** 2, 
        'GB': 1 * 1024 ** 3
        }

    # init for convert
    len_dict = {
        1: 'B',
        2: 'B',
        3: 'B',
        4: 'KB',
        5: 'KB',
        6: 'KB',
        7: 'MB',
        8: 'MB',
        9: 'MB',
        10: 'GB',
        11: 'GB',
        12: 'GB'
    }

    # sorted and count in DB
    for k, v in dictonary.items():
        size_bytes = 0
        for k2, v2 in v.items():
            if k == k2:
                dictonary[k][k2] = sorted(v2)
            else:
                dictonary[k][k2] = sum(v2)
                if k2 in size_dict.keys():
                    size_bytes += dictonary[k][k2] * size_dict[k2]
        dictonary[k]['size_bytes'] = dictonary.get('size_bytes', 0) + size_bytes
        dictonary[k]['result'] = round(
                                    dictonary[k]['size_bytes'] \
                                    / size_dict[len_dict[len(str(dictonary[k]['size_bytes']))]]
                                )
        dictonary[k]['size_name'] = len_dict[len(str(dictonary[k]['size_bytes']))]
        dictonary[k]['end'] = k
    # print(dictonary, sep='\n') # test
    # print_dict(dictonary) # test

    # convert DB dict to arr
    finish = list()
    for k, v in dictonary.items():
        buff = list()
        for k2, v2 in v.items():
            if k2 == k or 'result' == k2 or 'size_name' == k2 or 'end' == k2:
                buff.append(v2)
        finish.append(buff)
    # print(finish) # test
    # print_arr(finish) # test

    # sort arr
    finish = sorted(
        finish,
        key=lambda x: x[3]
    )
    # print_arr(finish) # test

    # output
    print_result_arr(finish)