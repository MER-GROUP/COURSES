'''
–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∫—É—Ä—Å—ã –±–µ—Ä—É—Ç —Å–≤–æ–µ üò¢
–î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –¢–∏–º—É—Ä —Ä–µ—à–∏–ª –∑–∞–Ω—è—Ç—å—Å—è –ø—Ä–æ–¥–∞–∂–µ–π –æ–≤–æ—â–µ–π. 
–£ –Ω–µ–≥–æ –∏–º–µ—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∑–∞ –≥–æ–¥, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–µ –Ω–∞ —á–µ—Ç—ã—Ä–µ —Ñ–∞–π–ª–∞ 
–ø–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º: quarter1.csv, quarter2.csv, quarter3.csv –∏ quarter4.csv. 
–í –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ –≤ –ø–µ—Ä–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞, 
–∞ –≤ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ –∫–∏–ª–æ–≥—Ä–∞–º–º–∞—Ö –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –º–µ—Å—è—Ü:

–ø—Ä–æ–¥—É–∫—Ç,—è–Ω–≤–∞—Ä—å,—Ñ–µ–≤—Ä–∞–ª—å,–º–∞—Ä—Ç
–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å,39,61,3
–î–∞–π–∫–æ–Ω,51,96,83
...

–¢–∞–∫–∂–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ñ–∞–π–ª prices.json, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å–ª–æ–≤–∞—Ä—å, 
–≤ –∫–æ—Ç–æ—Ä–æ–º –∫–ª—é—á–æ–º —è–≤–ª—è–µ—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ–º ‚Äî —Ü–µ–Ω–∞ –∑–∞ –∫–∏–ª–æ–≥—Ä–∞–º–º –≤ —Ä—É–±–ª—è—Ö:

{
   "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å": 53,
   "–î–∞–π–∫–æ–Ω": 55,
...
}

–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≤–æ–¥–∏—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ ‚Äî —Å—É–º–º—É, 
–∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—É—é –¢–∏–º—É—Ä–æ–º –∑–∞ –≥–æ–¥ –Ω–∞ –ø—Ä–æ–¥–∞–∂–µ –æ–≤–æ—â–µ–π.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –°—Å—ã–ª–∫–∏ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã: quarter1.csv, quarter2.csv, 
quarter3.csv, quarter4.csv, prices.json. –û—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞—á—É –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å—Å—ã–ª–∫–µ.
https://stepik.org/media/attachments/lesson/635441/quarter1.csv
https://stepik.org/media/attachments/lesson/635441/quarter2.csv
https://stepik.org/media/attachments/lesson/635441/quarter3.csv
https://stepik.org/media/attachments/lesson/635441/quarter4.csv
https://stepik.org/media/attachments/lesson/635441/prices.json
https://stepik.org/media/attachments/lesson/635441/clue_free.txt

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ UTF-8.
'''
from collections import Counter
import csv, json

# with open(file='031-quarter1.csv', mode='rt', encoding='utf-8', newline='') as _csv_1,\
#     open(file='031-quarter2.csv', mode='rt', encoding='utf-8', newline='') as _csv_2,\
#     open(file='031-quarter3.csv', mode='rt', encoding='utf-8', newline='') as _csv_3,\
#     open(file='031-quarter4.csv', mode='rt', encoding='utf-8', newline='') as _csv_4,\
#     open(file='031-prices.json', mode='rt', encoding='utf-8', newline='') as _json_1:
with open(file='quarter1.csv', mode='rt', encoding='utf-8', newline='') as _csv_1,\
    open(file='quarter2.csv', mode='rt', encoding='utf-8', newline='') as _csv_2,\
    open(file='quarter3.csv', mode='rt', encoding='utf-8', newline='') as _csv_3,\
    open(file='quarter4.csv', mode='rt', encoding='utf-8', newline='') as _csv_4,\
    open(file='prices.json', mode='rt', encoding='utf-8', newline='') as _json_1:
    
    _coounter = Counter()
    for k, *v in tuple(csv.reader(_csv_1, delimiter=','))[1:]:
        _coounter.update({k: sum(map(int, v))})
    for k, *v in tuple(csv.reader(_csv_2, delimiter=','))[1:]:
        _coounter.update({k: sum(map(int, v))})
    for k, *v in tuple(csv.reader(_csv_3, delimiter=','))[1:]:
        _coounter.update({k: sum(map(int, v))})
    for k, *v in tuple(csv.reader(_csv_4, delimiter=','))[1:]:
        _coounter.update({k: sum(map(int, v))})
    # print(_coounter) # test

    _dict = json.load(fp=_json_1)
    _sum = int()
    for k, v in _coounter.most_common():
        _sum += _dict[k] * v
    print(_sum)