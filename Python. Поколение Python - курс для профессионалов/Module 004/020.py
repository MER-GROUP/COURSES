'''
ÐŸÑ€Ð¾Ñ‰Ðµ, Ñ‡ÐµÐ¼ ÐºÐ°Ð¶ÐµÑ‚ÑÑ ðŸŒ¶ï¸
Ð Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ñ€Ð°Ð³Ð¼ÐµÐ½Ñ‚:

ball,color,purple
ball,size,4
ball,notes,it's round
cup,color,blue
cup,size,1
cup,notes,none

ÐšÐ°Ð¶Ð´Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ° ÑÑ‚Ð¾Ð³Ð¾ Ñ„Ñ€Ð°Ð³Ð¼ÐµÐ½Ñ‚Ð° ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ñ‚Ñ€Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ: Ð¸Ð¼Ñ Ð¾Ð±ÑŠÐµÐºÑ‚Ð°, 
ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð¾ ÑÑ‚Ð¾Ð³Ð¾ Ð¾Ð±ÑŠÐµÐºÑ‚Ð°, Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð°. ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð² Ð¿ÐµÑ€Ð²Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐµ ÑƒÐºÐ°Ð·Ð°Ð½ Ð¾Ð±ÑŠÐµÐºÑ‚ ball, 
Ð¸Ð¼ÐµÑŽÑ‰Ð¸Ð¹ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð¾ color, Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ñ€Ð°Ð²Ð½Ð¾ purple. 
Ð¢Ð°ÐºÐ¶Ðµ Ñƒ Ð¾Ð±ÑŠÐµÐºÑ‚Ð° ball ÐµÑÑ‚ÑŒ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð° size Ð¸ notes, Ð¸Ð¼ÐµÑŽÑ‰Ð¸Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ 4 Ð¸ it's round ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾. 
ÐŸÐ¾Ð¼Ð¸Ð¼Ð¾ Ð¾Ð±ÑŠÐµÐºÑ‚Ð° ball Ð¸Ð¼ÐµÐµÑ‚ÑÑ Ð¾Ð±ÑŠÐµÐºÑ‚ cup, Ð¸Ð¼ÐµÑŽÑ‰Ð¸Ð¹ Ñ‚Ðµ Ð¶Ðµ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð° Ð¸ Ð² Ñ‚Ð¾Ð¼ Ð¶Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ðµ. 
Ð”Ð°Ð´Ð¸Ð¼ ÑÑ‚Ð¸Ð¼ Ð¾Ð±ÑŠÐµÐºÑ‚Ð°Ð¼ Ð¾Ð±Ñ‰ÐµÐµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ object Ð¸ ÑÐ³Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€ÑƒÐµÐ¼ ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð´Ð°Ð½Ð½Ð¾Ð³Ð¾ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ð¾Ð³Ð¾ 
Ñ„Ñ€Ð°Ð³Ð¼ÐµÐ½Ñ‚Ð° Ð¿Ð¾ Ð¿ÐµÑ€Ð²Ð¾Ð¼Ñƒ ÑÑ‚Ð¾Ð»Ð±Ñ†Ñƒ:

object,color,size,notes
ball,purple,4,it's round
cup,blue,1,none

ÐœÑ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð»Ð¸ Ð·Ð°Ð¿Ð¸ÑÑŒ Ð² Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡Ð½Ð¾Ð¼ CSV Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ð² Ð¿ÐµÑ€Ð²Ð¾Ð¼ ÑÑ‚Ð¾Ð»Ð±Ñ†Ðµ ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¸Ð¼Ñ Ð¾Ð±ÑŠÐµÐºÑ‚Ð°, 
Ð° Ð² Ð¿Ð¾ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ñ… â€” Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… ÑÐ²Ð¾Ð¹ÑÑ‚Ð² ÑÑ‚Ð¾Ð³Ð¾ Ð¾Ð±ÑŠÐµÐºÑ‚Ð°.

Ð ÐµÐ°Ð»Ð¸Ð·ÑƒÐ¹Ñ‚Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ condense_csv(), ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð´Ð²Ð° Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð° Ð² ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ:

filename â€” Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ csv Ñ„Ð°Ð¹Ð»Ð°, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, data.csv; Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð° Ð°Ð½Ð°Ð»Ð¾Ð³Ð¸Ñ‡ÐµÐ½ 
Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ñƒ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ð¾Ð³Ð¾ Ñ„Ñ€Ð°Ð³Ð¼ÐµÐ½Ñ‚Ð°, Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð² ÑƒÑÐ»Ð¾Ð²Ð¸Ð¸ Ð·Ð°Ð´Ð°Ñ‡Ð¸: ÐºÐ°Ð¶Ð´Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ° Ñ„Ð°Ð¹Ð»Ð° ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ 
Ñ‚Ñ€Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ, Ð° Ð¸Ð¼ÐµÐ½Ð½Ð¾ Ð¸Ð¼Ñ Ð¾Ð±ÑŠÐµÐºÑ‚Ð°, ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð¾ ÑÑ‚Ð¾Ð³Ð¾ Ð¾Ð±ÑŠÐµÐºÑ‚Ð°, Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð°; 
Ð²ÑÐµ Ð¾Ð±ÑŠÐµÐºÑ‚Ñ‹ Ð¸Ð¼ÐµÑŽÑ‚ Ñ€Ð°Ð²Ð½Ñ‹Ðµ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð° Ð¸ Ð² Ñ€Ð°Ð²Ð½Ñ‹Ñ… ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð°Ñ…

id_name â€” Ð¾Ð±Ñ‰ÐµÐµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð´Ð»Ñ Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð²

Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð¿Ñ€Ð¸Ð²ÐµÑÑ‚Ð¸ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ñ„Ð°Ð¹Ð»Ð° Ð² Ð¿Ñ€Ð¸Ð²Ñ‹Ñ‡Ð½Ñ‹Ð¹ CSV Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚, ÑÐ³Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð² ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð¿Ð¾ Ð¿ÐµÑ€Ð²Ð¾Ð¼Ñƒ 
ÑÑ‚Ð¾Ð»Ð±Ñ†Ñƒ Ð¸ Ð½Ð°Ð·Ð²Ð°Ð² Ð¿ÐµÑ€Ð²Ñ‹Ð¹ ÑÑ‚Ð¾Ð»Ð±ÐµÑ† id_name. ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ 
Ð² Ñ„Ð°Ð¹Ð» condensed.csv.

ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ 1. ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ÐµÑÐ»Ð¸ Ð±Ñ‹ Ñ„Ð°Ð¹Ð» data.csv Ð¸Ð¼ÐµÐ» ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ Ð²Ð¸Ð´:

01,Title,Ran So Hard the Sun Went Down
02,Title,Honky Tonk Heroes (Like Me)

Ñ‚Ð¾ Ð²Ñ‹Ð·Ð¾Ð² Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ condense_csv():

condense_csv('data.csv', id_name='ID')

Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ð» Ð±Ñ‹ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð» condensed.csv ÑÐ¾ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸ÐµÐ¼:

ID,Title
01,Ran So Hard the Sun Went Down
02,Honky Tonk Heroes (Like Me)

ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ 2. Ð“Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚ÑÑ, Ñ‡Ñ‚Ð¾ Ð² Ð¿ÐµÑ€ÐµÐ´Ð°Ð²Ð°ÐµÐ¼Ð¾Ð¼ Ð² Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ csv Ñ„Ð°Ð¹Ð»Ðµ Ñ€Ð°Ð·Ð´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÐµÐ¼ ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð·Ð°Ð¿ÑÑ‚Ð°Ñ, 
Ð¿Ñ€Ð¸ ÑÑ‚Ð¾Ð¼ ÐºÐ°Ð²Ñ‹Ñ‡ÐºÐ¸ Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ.

ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ 3. ÐŸÑ€Ð¸ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ Ñ„Ð°Ð¹Ð»Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÑÐ²Ð½Ð¾Ðµ ÑƒÐºÐ°Ð·Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²ÐºÐ¸ UTF-8.

ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ 4. Ð’ Ñ‚ÐµÑÑ‚Ð¸Ñ€ÑƒÑŽÑ‰ÑƒÑŽ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ ÑÐ´Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñƒ, ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‰ÑƒÑŽ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ condense_csv(), 
Ð½Ð¾ Ð½Ðµ ÐºÐ¾Ð´, Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÑŽÑ‰Ð¸Ð¹ ÐµÐµ.

ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ 5. Ð¢ÐµÑÑ‚Ð¾Ð²Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹ Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ.
https://stepik.org/media/attachments/lesson/518491/tests_3069917.zip
'''
import csv

def condense_csv(filename, id_name):
    with open(file=filename, mode='rt', encoding='utf-8', newline='') as file_opener,\
        open(file='condensed.csv', mode='wt', encoding='utf-8', newline='') as file_writener:

        csv_opener = tuple(csv.reader(file_opener, delimiter=',', quoting=csv.QUOTE_NONE))
        # print(csv_opener) # test

        arr = [{id_name: v, k1: v1} for v, k1, v1 in csv_opener]
        # print(arr) # test

        id_one = list(arr[0].values())[0]
        # print(id_one) # test

        fieldnames = [id_name]
        for d in arr:
            if d[id_name] == id_one:
                fieldnames += [list(d.keys())[1]]
        # print(fieldnames) # test

        arr_writener = list()
        buff_writener = list()
        i = 1
        fieldnames_len = len(fieldnames) - 1
        # print(f'fieldnames_len = {fieldnames_len}') # test

        for line_dict in arr:
            # print(line_dict) # test
            # print(f'i = {i}') # test
            if fieldnames_len >= i:
                if 1 == i:
                    buff_writener.append(list(line_dict.values())[0])
                buff_writener.append(list(line_dict.values())[1])
                if fieldnames_len == i:
                    arr_writener.append(buff_writener.copy())
                    buff_writener.clear()
                    # print(arr_writener) # test
                    i = 1
                    continue
            i += 1
        # print(arr_writener) # test

        csv_writener = csv.writer(file_writener, delimiter=',', quoting=csv.QUOTE_NONE)
        csv_writener.writerow(fieldnames)
        csv_writener.writerows(arr_writener)

if __name__ == '__main__':
    condense_csv('020-data.csv', id_name='ID')